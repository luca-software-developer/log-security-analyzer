title = "Log Security Analyzer Rules"
description = "Optimized ruleset for application logs"

[[rules]]
id = "github-pat"
description = "GitHub Personal Access Token"
regex = '''ghp_[A-Za-z0-9]{36}'''
tags = ["github", "token", "log", "runtime"]
severity = "critical"

[[rules]]
id = "slack-bot-token"
description = "Slack Bot Token"
regex = '''xoxb-[0-9]{10,}-[A-Za-z0-9]{20,}'''
tags = ["slack", "token", "log", "runtime"]
severity = "high"

[[rules]]
id = "aws-access-key-id"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws", "key", "log", "runtime"]
severity = "high"

[[rules]]
id = "aws-secret-access-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws_secret_access_key[=:][A-Za-z0-9/+=]{20,}'''
tags = ["aws", "secret", "log", "runtime"]
severity = "critical"

[[rules]]
id = "postgres-connection-string"
description = "PostgreSQL Connection String"
regex = '''postgresql://[^\s'"]+'''
tags = ["database", "credential", "log", "runtime"]
severity = "high"

[[rules]]
id = "mysql-connection-string"
description = "MySQL Connection String"
regex = '''mysql://[^\s'"]+'''
tags = ["database", "credential", "log", "runtime"]
severity = "high"

[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+'''
tags = ["jwt", "token", "log", "runtime"]
severity = "high"

[[rules]]
id = "private-key-header"
description = "Private Key Header"
regex = '''-----BEGIN (RSA )?PRIVATE KEY-----'''
tags = ["private-key", "log", "runtime"]
severity = "critical"

[[rules]]
id = "private-key-footer"
description = "Private Key Footer"
regex = '''-----END (RSA )?PRIVATE KEY-----'''
tags = ["private-key", "log", "runtime"]
severity = "critical"
